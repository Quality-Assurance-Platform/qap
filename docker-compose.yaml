version: "3"
services:
  qap-db:
    container_name: qap-db
    image: postgres:10
    restart: always
    environment:
      POSTGRES_DB: 'qap'
      POSTGRES_PASSWORD: 'password'
    volumes:
      - ./qap-pgdata:/var/lib/postgresql/data/pgdata

  qap-ui:
    container_name: qap-ui
    image: grafana/grafana:6.3.3
    restart: always
    ports:
      - 80:3000
    depends_on:
      - qap-db

  qap-svc:
    container_name: qap-svc
    image: bxwill/qap:svc
    restart: always
    ports:
      - 6001:6001
    environment:
      PG_DB: 'qap'
      PG_SERVER: qap-db
      PG_USER: 'postgres'
      PG_PASSWORD: 'password'
    depends_on:
      - qap-db
      - qap-ui

  qap-mgmt-ui:
    container_name: qap-mgmt-ui
    image: bxwill/qap:mui
    restart: always
    ports:
      - 8080:80
    depends_on:
      - qap-svc
